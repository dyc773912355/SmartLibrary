<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <!-- Meta, title, CSS, favicons, etc. -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>图书馆报告</title>
    <!-- Bootstrap -->
    <link href="../vendors/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="../vendors/font-awesome/css/font-awesome.min.css" rel="stylesheet">
    <!-- NProgress -->
    <link href="../vendors/nprogress/nprogress.css" rel="stylesheet">
    <!-- Animate.css -->
    <link href="../vendors/animate.css/animate.min.css" rel="stylesheet">

    <!-- Custom Theme Style -->
    <link href="../build/css/custom.min.css" rel="stylesheet">

    <!-- jQuery -->
    <script type="text/javascript" src="../vendors/jquery/dist/jquery.min.js"></script>
    <!-- 引入 ECharts 文件 -->
    <script src="../../js/echarts.min.js"></script>
</head>
<script type="application/javascript">
    function getResourceCountBy_year() {
        $.ajax({
            type:'get',
            url:'../../schoolReport/getResourceCountBy_year',
            contentType: 'application/json',
            async:false,
            dataType: 'json',
            success: function(data, textStatus, jqXHR){
                var year = [];
                var count = [];
                var count1 = [];
                for(var i=0;i<data.length;i++){
                    year.push(data[i].year);
                    count.push({
                        value:data[i].count,
                        itemStyle:{
                            normal:{
                                color:'orange'

                            }
                        }
                    });
                    count1.push(data[i].count)
                }
                var getResourceCountBy_year = echarts.init(document.getElementById('getResourceCountBy_year'));
                var option = {
                    backgroundColor:'white',
                    animation:false,
                    xAxis: [
                        {
                            name:'年',
                            type: 'category',
                            show:true,
                            data: year,
                            axisPointer: {
                                type: 'shadow'
                            },
                            axisTick: {
                                show: false
                            },
                        }
                    ],

                    yAxis: [
                        {
                            type: 'value',
                            name: '资源数',
                            /*min: 0,
                            max:100,
                            interval: 20,*/
                            axisLabel: {
                                formatter: '{value}'
                            },
                            axisTick: {
                                show: false
                            }
                        },

                    ],
                    series: [
                        {
                            /*name:'保障率',*/
                            type:'bar',
                            barWidth: '30%',
                            data:count,
                            label: {
                                normal: {
                                    show: true,
                                    position: 'top',
                                    formatter: '{c}'
                                }
                            },
                        },

                        {
                            type:'line',
                            name:'占比',
                            data:count1
                        }
                    ],
                };
                getResourceCountBy_year.setOption(option);
            }
        });
    }
    function getGctrlsCountBy_year() {
        $.ajax({
            type:'get',
            url:'../../schoolReport/getGctrlsCountBy_year',
            contentType:'application/json',
            async:false,
            dataType:'json',
            success:function (data) {
                var year = [];
                var gctrl = []
                for(var i=0;i<data.length;i++){
                    year.push(data[i].year);
                    gctrl.push(data[i].gctrls);
                }
                var getgetGctrlsCountBy_year = echarts.init(document.getElementById('getGctrlsCountBy_year'));
                var GctrlsCountBy_yearoption = {
                    animation:false,
                    backgroundColor:'white',
                    color: ['#3398DB'],
                    tooltip : {
                        trigger: 'axis',
                        axisPointer : {            // 坐标轴指示器，坐标轴触发有效
                            type : 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
                        }
                    },
                    grid: {
                        left: '3%',
                        right: '4%',
                        bottom: '3%',
                        containLabel: true
                    },
                    xAxis : [
                        {
                            name:'年',
                            type : 'category',
                            data : year,
                            axisTick: {
                                alignWithLabel: true
                            }
                        }
                    ],
                    yAxis : [
                        {
                            // type : 'category',
                            // data : ['10','20','30','40'],
                            name:"人次",
                            axisTick: {
                                alignWithLabel: true
                            }
                        }
                    ],
                    series : [
                        {
                            name:'进馆人次',
                            type:'bar',
                            barWidth: '40%',
                            data:gctrl
                        },

                    ],
                    label: {
                        normal: {
                            show: true,
                            position: 'top',
                            formatter: '{c}'
                        }
                    },
                    itemStyle: {
                        normal: {

                            color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{
                                offset: 0,
                                color: 'rgba(17, 168,171, 1)'
                            }, {
                                offset: 1,
                                color: 'rgba(17, 168,171, 0.1)'
                            }]),
                            shadowColor: 'rgba(0, 0, 0, 0.1)',
                            shadowBlur: 10
                        }
                    }
                };
                getgetGctrlsCountBy_year.setOption(GctrlsCountBy_yearoption);
            }
        });

    }
    function getGctrlsCountBy_month() {
        $.ajax({
           type:'get',
            contentType:'application/json',
            url:'../../schoolReport/getGctrlsCountBy_month',
            dataType:'json',
            async:false,
            success:function (data) {
                var month = [];
                var gctrl_times = [];
                for(var i=0;i<data.length;i++){
                    month.push(data[i].month+'月');
                    gctrl_times.push(data[i].gctrl_times);
                }
                var getGctrlsCountBy_month = echarts.init(document.getElementById('getGctrlsCountBy_month'));
                var getGctrlsCountBy_monthoption = {
                    animation:false,
                    backgroundColor:'white',
                    tooltip : {
                        trigger: 'axis'
                    },
                    calculable : true,
                    xAxis : [
                        {
                            name:'月',
                            type : 'category',
                            data : month
                        }
                    ],
                    yAxis : [
                        {
                            name:'人次',
                            type : 'value'
                        }
                    ],
                    series : [
                        {
                            name:'进馆人次',
                            type:'bar',
                            data:gctrl_times,
                            itemStyle: {
                                normal: {
                                    color: function(params) {
                                        // build a color map as your need.
                                        var colorList = [
                                            '#C1232B','#B5C334','#FCCE10','#E87C25','#27727B',
                                            '#FE8463','#9BCA63','#FAD860','#F3A43B','#60C0DD',
                                            '#D7504B','#C6E579','#F4E001','#F0805A','#26C0C0'
                                        ];
                                        return colorList[params.dataIndex]
                                    },label: {
                                        show: true,
                                        position: 'top',
                                        formatter: '{b}\n{c}'
                                    }
                                }
                            }
                        }
                    ]
                };
                getGctrlsCountBy_month.setOption(getGctrlsCountBy_monthoption);
            }
        });
    }
    function getmankindGctrl_Byoneyear() {
        $.ajax({
            type:'get',
            contentType:'application/json',
            url:'../../schoolReport/getmankindCount_Byoneyear',
            async:false,
            dataType:'json',
            success:function(data){
                var gctrldata = [];
                for(var i=0;i<data.length;i++){
                    gctrldata.push({
                        value:data[i].gctrl,
                        name:data[i].man_kind
                    });
                }
                var getmankindGctrl_Byoneyear = echarts.init(document.getElementById('getmankindGctrl_Byoneyear'));
                var getmankindGctrl_Byoneyearoption = {
                    animation:false,
                    backgroundColor:'white',
                    tooltip : {
                        trigger: 'item',
                        formatter: "{a} <br/>{b} : {c} ({d}%)"
                    },
                    calculable : true,
                    series : [
                        {
                            name:data[0].year+'年',
                            type:'pie',
                            radius : [50, 150],
                            center : ['50%', '50%'],
                            roseType : 'radius',
                            data:gctrldata
                        }
                    ]
                };
                getmankindGctrl_Byoneyear.setOption(getmankindGctrl_Byoneyearoption);
            }
        })
    }
    function getmankindCount_Byyear() {
        $.ajax({
            type:'get',
            contentType:'application/json',
            url:'../../schoolReport/getmankindCount_Byyear',
            dataType:'json',
            async:false,
            success:function (data) {
                var getmankindCount_Byyearyear = new Array();
                var mankinddata = [];
                var other = [];
                var student = [];
                var teacher = [];
                var gradute = [];
                for(var i=0;i<data.length;i++){
                    if($.inArray(data[i].year, getmankindCount_Byyearyear)==-1){
                        getmankindCount_Byyearyear.push(data[i].year);
                    }
                    if(data[i].man_kind=='其他'){
                        other.push(data[i].gctrl);
                    }
                    else if(data[i].man_kind=='教职工'){
                        teacher.push(data[i].gctrl);
                    }
                    else if(data[i].man_kind=='本科生'){
                        student.push(data[i].gctrl);
                    }
                    else if(data[i].man_kind=='研究生'){
                        gradute.push(data[i].gctrl);
                    }
                }
                console.log(getmankindCount_Byyearyear);
                mankinddata.push({
                    name:'其他',
                    type:'line',
                    data:other
                });
                mankinddata.push({
                    name:'教职工',
                    type:'line',
                    data:teacher
                });
                mankinddata.push({
                    name:'本科生',
                    type:'line',
                    data:student
                });
                mankinddata.push({
                    name:'研究生',
                    type:'line',
                    data:gradute
                });
                var getmankindCount_Byyear = echarts.init(document.getElementById('getmankindCount_Byyear'));
                var getmankindCount_Byyearoption = {
                    animation:false,
                    backgroundColor:'white',
                    xAxis: {
                        name:'年',
                        data:getmankindCount_Byyearyear,
                    },
                    legend: {
                        align: 'right',
                        data: ['其他','教职工','本科生','研究生'],
                        textStyle: {
                            align: 'right',
                            baseline: 'middle',
                            fontFamily: 'IRANSans'
                        }
                    },
                    yAxis: {
                        name:'人次'
                    },
                    series: mankinddata
                };
                getmankindCount_Byyear.setOption(getmankindCount_Byyearoption);
            }
        })
    }
    function getBook_LendCountBy_year() {
        $.ajax({
            type:'get',
            contentType:'application/json',
            url:'../../schoolReport/getBook_LendCountBy_year',
            async:false,
            dataType:'json',
            success:function (data) {
                var book_lend_year = [];
                var book_lend_times = [];
                var book_return_times = [];
                for(var i=0;i<data.length;i++){
                    book_lend_year.push(data[i].year);
                    book_lend_times.push(data[i].book_lend_times);
                    book_return_times.push(data[i].book_return_times);
                }
                var getBook_LendCountBy_year = echarts.init(document.getElementById('getBook_LendCountBy_year'));
                var getBook_LendCountBy_yearoption ={
                    animation:false,
                    backgroundColor:'white',
                    tooltip : {
                        trigger: 'axis',
                        axisPointer : {            // 坐标轴指示器，坐标轴触发有效
                            type : 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
                        }
                    },
                    legend: {
                        data: ['借书', '还书']
                    },
                    grid: {
                        left: '3%',
                        right: '4%',
                        bottom: '3%',
                        containLabel: true
                    },
                    yAxis:  {
                        name:'册',
                        type: 'value'
                    },
                    xAxis: {
                        name:'年',
                        type: 'category',
                        data: book_lend_year
                    },
                    series: [
                        {
                            name: '借书',
                            type: 'bar',
                            stack: '总量',
                            label: {
                                normal: {
                                    show: true,
                                    position: 'inside'
                                }
                            },
                            data: book_lend_times
                        },
                        {
                            name: '还书',
                            type: 'bar',
                            stack: '总量',
                            label: {
                                normal: {
                                    show: true,
                                    position: 'inside'
                                }
                            },
                            data: book_return_times
                        }
                    ]
                };
                getBook_LendCountBy_year.setOption(getBook_LendCountBy_yearoption);
            }
        })
    }
    function getBookkindAllCount_Byyear() {
        $.ajax({
            type:'get',
            contentType:'application/json',
            url:'../../schoolReport/getBookkindAllCount_Byyear',
            async:false,
            dataType:'json',
            success:function (data) {
                var bookkind = [];
                var bookkinddata = [];
                for(var i=0;i<data.length;i++){
                    bookkind.push(data[i].book_kind);
                    bookkinddata.push(data[i].book_lend_times);
                }
                var getBookkindAllCount_Byyear = echarts.init(document.getElementById('getBookkindAllCount_Byyear'));
                var getBookkindAllCount_Byyearoption = {
                    animation:false,
                    backgroundColor:'white',
                    tooltip: {
                        trigger: 'axis',
                        axisPointer: {
                            type: null // 默认为直线，可选为：'line' | 'shadow'
                        },
                        formatter: '{b} : {c}'
                    },
                    xAxis: [{
                        type: 'value',
                        axisLabel: {
                            show: false
                        },
                        axisTick: {
                            show: false
                        },
                        axisLine: {
                            show: false
                        },
                        splitLine: {
                            show: false
                        }

                    }],
                    yAxis: [{
                        type: 'category',
                        boundaryGap: true,
                        axisTick: {
                            show: true
                        },
                        axisLabel: {
                            interval: null
                        },
                        data: bookkind,
                        splitLine: {
                            show: false
                        }
                    }],
                    series: [{
                        type: 'bar',
                        barWidth: 25,
                        label: {
                            normal: {
                                show: true,
                                position: 'right'
                            }

                        },
                        data: bookkinddata
                    }]
                };
                getBookkindAllCount_Byyear.setOption(getBookkindAllCount_Byyearoption);
            }
        })
    }
    function getBook_LendCountBy_academyAndyear() {
        $.ajax({
            type:'get',
            contentType:'application/json',
            url:'../../schoolReport/getBook_LendCountBy_academyAndyear',
            dataType:'json',
            async:false,
            success:function (data) {
                var academy = [];
                var academylend = [];
                for(var i=0;i<data.length;i++){
                    academy.push(data[i].academy);
                    academylend.push(data[i].lend);
                }
                var getBook_LendCountBy_academyAndyear = echarts.init(document.getElementById('getBook_LendCountBy_academyAndyear'));
                var getBook_LendCountBy_academyAndyearoption = {
                    animation:false,
                    backgroundColor:'white',
                    color: ['#3398DB'],
                    tooltip : {
                        trigger: 'axis',
                        axisPointer : {            // 坐标轴指示器，坐标轴触发有效
                            type : 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
                        }
                    },
                    grid: {
                        left: '3%',
                        right: '6%',
                        bottom: '13%',
                        containLabel: true
                    },
                    xAxis : [
                        {
                            name:'学院',
                            type : 'category',
                            data : academy,
                            axisTick: {
                                alignWithLabel: true
                            },
                            "axisLabel": {
                                "interval": 0,
                                "rotate": 30,
                                "show": true,
                                "splitNumber": 15,
                                "textStyle": {
                                    "fontFamily": "微软雅黑",
                                    "fontSize": 12
                                }
                            }
                        }
                    ],
                    yAxis : [
                        {
                            // type : 'category',
                            // data : ['10','20','30','40'],
                            name:'册',
                            axisTick: {
                                alignWithLabel: true
                            }
                        }
                    ],
                    series : [
                        {
                            name:'借阅',
                            type:'bar',
                            barWidth: '40%',
                            data:academylend
                        },

                    ],
                    label: {
                        normal: {
                            show: true,
                            position: 'top',
                            formatter: '{c}'
                        }
                    },
                    itemStyle: {
                        normal: {

                            color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{
                                offset: 0,
                                color: 'rgba(17, 168,171, 1)'
                            }, {
                                offset: 1,
                                color: 'rgba(17, 168,171, 0.1)'
                            }]),
                            shadowColor: 'rgba(0, 0, 0, 0.1)',
                            shadowBlur: 10
                        }
                    }
                };
                getBook_LendCountBy_academyAndyear.setOption(getBook_LendCountBy_academyAndyearoption);
            }

        })
        
    }
    function getbooklendPeopleAndCount_Byhour() {
      $.ajax({
          type:'get',
          contentType:'application/json',
          url:'../../schoolReport/getbooklendPeopleAndCount_Byhour',
          dataType:'json',
          async:false,
          success:function (data) {
              var booklendhour = [];
              var lendpeople = [];
              var lendbookdata = [];
              for(var i=0;i<data.length;i++){
                  booklendhour.push(data[i].hour+"点");
                  lendpeople.push(data[i].lend_people);
                  lendbookdata.push(data[i].lend);
              }
              var getbooklendPeopleAndCount_Byhour = echarts.init(document.getElementById('getbooklendPeopleAndCount_Byhour'));
              var getbooklendPeopleAndCount_Byhouroption = {
                  animation:false,
                  backgroundColor: 'white',
                  tooltip: {
                      trigger: 'axis',
                      axisPointer: {
                          lineStyle: {
                              color: '#57617B'
                          }
                      }
                  },
                  legend: {
                      icon: 'rect',
                      itemWidth: 14,
                      itemHeight: 5,
                      itemGap: 13,
                      data: ['借出册数', '借出人数'],
                      right: '4%',
                  },
                  grid: {
                      left: '3%',
                      right: '6%',
                      bottom: '3%',
                      containLabel: true
                  },
                  xAxis: [{
                      name:'小时',
                      type: 'category',
                      boundaryGap: false,
                      axisLine: {
                          lineStyle: {
                              color: '#57617B'
                          }
                      },
                      data: booklendhour
                  }],
                  yAxis: [{
                      type: 'value',
                      axisTick: {
                          show: false
                      },
                      axisLine: {
                          lineStyle: {
                              color: '#57617B'
                          }
                      },
                      axisLabel: {
                          margin: 10,
                          textStyle: {
                              fontSize: 14
                          }
                      },
                      splitLine: {
                          lineStyle: {
                              color: '#57617B'
                          },
                          show:false,
                      }
                  }],
                  series: [{
                      name: '借出册数',
                      type: 'line',
                      smooth: true,
                      lineStyle: {
                          normal: {
                              width: 1
                          }
                      },
                      areaStyle: {
                          normal: {
                              color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{
                                  offset: 0,
                                  color: 'rgba(17, 168, 171, 1)'
                              }, {
                                  offset: 0.8,
                                  color: 'rgba(17, 168, 171, 0.3)'
                              }], false),
                              shadowColor: 'rgba(0, 0, 0, 0.1)',
                              shadowBlur: 10
                          }
                      },
                      itemStyle: {
                          normal: {
                              color: 'rgb(17, 168, 171)',
                              borderColor: 'rgba(17,168,171,0.27)',
                              borderWidth: 6
                          }
                      },
                      data: lendbookdata
                  }, {
                      name: '借出人数',
                      type: 'line',
                      smooth: true,
                      lineStyle: {
                          normal: {
                              width: 1
                          }
                      },
                      areaStyle: {
                          normal: {
                              color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{
                                  offset: 0,
                                  color: 'rgba(255, 69, 0, 1)'
                              }, {
                                  offset: 0.8,
                                  color: 'rgba(255, 69, 0, 0.3)'
                              }], false),
                              shadowColor: 'rgba(0, 0, 0, 0.1)',
                              shadowBlur: 10
                          }
                      },
                      itemStyle: {
                          normal: {
                              color: 'rgb(255,69,0)',
                              borderColor: 'rgba(255,69,0,0.2)',
                              borderWidth: 6

                          }
                      },
                      data: lendpeople
                  } ]
              };
              getbooklendPeopleAndCount_Byhour.setOption(getbooklendPeopleAndCount_Byhouroption);
          }
      })
    }
    function getlend_student_type(){
        $.ajax({
            type:'get',
            contentType:'application/json',
            url:'../../schoolReport/getmankindCount_Byoneyear',
            async:false,
            dataType:'json',
            success:function (data) {
                var colorList = [
                    '#59c5a7', '#51b8fe', '#fa827d','#FFCC67'
                ];

                // 总和
                var total = {
                    name: '总借阅数',
                    value: data[0].lend+data[1].lend+data[2].lend+data[3].lend
                }

                var originalData = [{
                    value: data[0].lend,
                    name: '其他：'+data[0].lend
                }, {
                    value: data[1].lend,
                    name: '教职工：'+data[1].lend
                }, {
                    value: data[2].lend,
                    name: "本科生："+data[2].lend
                }, {
                    value: data[3].lend,
                    name: "研究生："+data[3].lend
                },
                ];
                echarts.util.each(originalData, function(item, index) {
                    item.itemStyle = {
                        normal: {
                            color: colorList[index]
                        }
                    };
                });
                var getlend_student_typeoption = {
                    animation:false,
                    backgroundColor:'white',
                    title: [{
                        text: total.name,
                        left: '49%',
                        top: '46%',
                        textAlign: 'center',
                        textBaseline: 'middle',
                        textStyle: {
                            color: '#999',
                            fontWeight: 'normal',
                            fontSize: 20
                        }
                    }, {
                        text: total.value,
                        left: '49%',
                        top: '51%',
                        textAlign: 'center',
                        textBaseline: 'middle',
                        textStyle: {
                            color: '#666',
                            fontWeight: 'normal',
                            fontSize: 40
                        }
                    }],
                    series: [{
                        hoverAnimation: false, //设置饼图默认的展开样式
                        radius: [100, 190],
                        name: 'pie',
                        type: 'pie',
                        selectedMode: 'single',
                        selectedOffset: 16, //选中是扇区偏移量
                        clockwise: true,
                        startAngle: 90,
                        label: {
                            normal: {
                                textStyle: {
                                    fontSize: 18,
                                    color: '#999'
                                }
                            }
                        },
                        labelLine: {
                            normal: {
                                lineStyle: {
                                    color: '#999',

                                }
                            }
                        },
                        data: originalData
                    }]
                };
                var getlend_student_type = echarts.init(document.getElementById('getlend_student_type'));
                getlend_student_type.setOption(getlend_student_typeoption);
            }
        })
    }
    function getlendrenew_student_type(){
        $.ajax({
            type:'get',
            contentType:'application/json',
            url:'../../schoolReport/getmankindCount_Byoneyear',
            async:false,
            dataType:'json',
            success:function (data) {
                var colorList = [
                    '#59c5a7', '#51b8fe', '#fa827d','#FFCC67'
                ];

                // 总和
                var total = {
                    name: '总续借数',
                    value: data[0].renew+data[1].renew+data[2].renew+data[3].renew
                }

                var originalData = [{
                    value: data[0].renew,
                    name: '其他：'+data[0].renew
                }, {
                    value: data[1].renew,
                    name: '教职工：'+data[1].renew
                }, {
                    value: data[2].renew,
                    name: "本科生："+data[2].renew
                }, {
                    value: data[3].renew,
                    name: "研究生："+data[3].renew
                },
                ];
                echarts.util.each(originalData, function(item, index) {
                    item.itemStyle = {
                        normal: {
                            color: colorList[index]
                        }
                    };
                });
                var getlendrenew_student_typeoption = {
                    animation:false,
                    backgroundColor:'white',
                    title: [{
                        text: total.name,
                        left: '49%',
                        top: '46%',
                        textAlign: 'center',
                        textBaseline: 'middle',
                        textStyle: {
                            color: '#999',
                            fontWeight: 'normal',
                            fontSize: 20
                        }
                    }, {
                        text: total.value,
                        left: '49%',
                        top: '51%',
                        textAlign: 'center',
                        textBaseline: 'middle',
                        textStyle: {
                            color: '#666',
                            fontWeight: 'normal',
                            fontSize: 40
                        }
                    }],
                    series: [{
                        hoverAnimation: false, //设置饼图默认的展开样式
                        radius: [100, 190],
                        name: 'pie',
                        type: 'pie',
                        selectedMode: 'single',
                        selectedOffset: 16, //选中是扇区偏移量
                        clockwise: true,
                        startAngle: 90,
                        label: {
                            normal: {
                                textStyle: {
                                    fontSize: 18,
                                    color: '#999'
                                }
                            }
                        },
                        labelLine: {
                            normal: {
                                lineStyle: {
                                    color: '#999',

                                }
                            }
                        },
                        data: originalData
                    }]
                };
                var getlendrenew_student_type = echarts.init(document.getElementById('getlendrenew_student_type'));
                getlendrenew_student_type.setOption(getlendrenew_student_typeoption);
            }
        })
    }
    function geICdurationCountBy_year() {
        $.ajax({
            type:'get',
            contentType:'application/json',
            url:'../../schoolReport/geICdurationCountBy_year',
            dataType:'json',
            async:false,
            success:function (data) {
                var icdurationmonth = [];
                var idduration_times = [];
                for(var i=0;i<data.length;i++){
                    icdurationmonth.push(data[i].month+'月');
                    idduration_times.push(data[i].eread_times);
                }
                var geICdurationCountBy_year = echarts.init(document.getElementById('geICdurationCountBy_year'));
                var geICdurationCountBy_yearoption = {
                    animation:false,
                    backgroundColor:'white',
                    tooltip : {
                        trigger: 'axis'
                    },
                    calculable : true,
                    xAxis : [
                        {
                            name:'月',
                            type : 'category',
                            data : icdurationmonth
                        }
                    ],
                    yAxis : [
                        {
                            name:'次',
                            type : 'value'
                        }
                    ],
                    series : [
                        {
                            name:'进馆人次',
                            type:'bar',
                            data:idduration_times,
                            itemStyle: {
                                normal: {
                                    color: function(params) {
                                        // build a color map as your need.
                                        var colorList = [
                                            '#C1232B','#B5C334','#FCCE10','#E87C25','#27727B',
                                            '#FE8463','#9BCA63','#FAD860','#F3A43B','#60C0DD',
                                            '#D7504B','#C6E579','#F4E001','#F0805A','#26C0C0'
                                        ];
                                        return colorList[params.dataIndex]
                                    },label: {
                                        show: true,
                                        position: 'top',
                                        formatter: '{b}\n{c}'
                                    }
                                }
                            }
                        }
                    ]
                };
                geICdurationCountBy_year.setOption(geICdurationCountBy_yearoption);
            }
        });
    }
    function geICdurationBy_year(){
        $.ajax({
            type:'get',
            contentType:'application/json',
            url:'../../schoolReport/geICdurationBy_year',
            async:false,
            dataType:'json',
            success:function (data) {
                var colorList = [
                    '#59c5a7', '#51b8fe', '#fa827d','#FFCC67'
                ];

                // 总和
                var total = {
                    name: '总次数',
                    value: data[0].lessone+data[0].onetotwo+data[0].twotofive+data[0].morefive
                }

                var originalData = [{
                    value: data[0].lessone,
                    name: '小于1小时：'+data[0].lessone
                }, {
                    value: data[0].onetotwo,
                    name: '1-2小时：'+data[0].onetotwo
                }, {
                    value: data[0].twotofive,
                    name: "2-5小时："+data[0].twotofive
                }, {
                    value: data[0].morefive,
                    name: "5小时以上："+data[0].morefive
                },
                ];
                echarts.util.each(originalData, function(item, index) {
                    item.itemStyle = {
                        normal: {
                            color: colorList[index]
                        }
                    };
                });
                var geICdurationBy_yearoption = {
                    animation:false,
                    backgroundColor:'white',
                    title: [{
                        text: total.name,
                        left: '49%',
                        top: '46%',
                        textAlign: 'center',
                        textBaseline: 'middle',
                        textStyle: {
                            color: '#999',
                            fontWeight: 'normal',
                            fontSize: 20
                        }
                    }, {
                        text: total.value,
                        left: '49%',
                        top: '51%',
                        textAlign: 'center',
                        textBaseline: 'middle',
                        textStyle: {
                            color: '#666',
                            fontWeight: 'normal',
                            fontSize: 40
                        }
                    }],
                    series: [{
                        hoverAnimation: false, //设置饼图默认的展开样式
                        radius: [100, 190],
                        name: 'pie',
                        type: 'pie',
                        selectedMode: 'single',
                        selectedOffset: 16, //选中是扇区偏移量
                        clockwise: true,
                        startAngle: 90,
                        label: {
                            normal: {
                                textStyle: {
                                    fontSize: 18,
                                    color: '#999'
                                }
                            }
                        },
                        labelLine: {
                            normal: {
                                lineStyle: {
                                    color: '#999',

                                }
                            }
                        },
                        data: originalData
                    }]
                };
                var geICdurationBy_year = echarts.init(document.getElementById('geICdurationBy_year'));
                geICdurationBy_year.setOption(geICdurationBy_yearoption);
            }
        })
    }
    function geteread_hour() {
        $.ajax({
            type:'get',
            contentType:'application/json',
            url:'../../schoolReport/getDeviceCount_Byhour',
            dataType:'json',
            async:false,
            success:function (data) {
                var ereadshour = [];
                var ereadshourtimes = [];
                for(var i=0;i<data.length;i++){
                    ereadshour.push(data[i].hour);
                    ereadshourtimes.push(data[i].ereads);
                }
                var geteread_hour = echarts.init(document.getElementById('geteread_hour'));
                var geteread_houroption = {
                    animation:false,
                    backgroundColor:'white',
                    tooltip: {
                        trigger: 'axis'
                    },
                    legend: {
                        data: ['使用次数']
                    },
                    grid: {
                        left: '3%',
                        right: '4%',
                        bottom: '3%',
                        containLabel: true
                    },
                    xAxis: {
                        type: 'category',
                        boundaryGap: false,
                        data: ereadshour,
                        splitLine: { //设置X轴的网格
                            show: true,
                            interval: 'auto'
                        },
                        axisLine: { //设置X轴的颜色
                            lineStyle: {
                                color: 'blue'
                            }
                        }
                    },
                    yAxis: {
                        type: 'value',
                        axisLine: { //设置y轴的颜色
                            lineStyle: {
                                color: 'blue'
                            }
                        }
                    },
                    series: [{
                        name: '使用次数',
                        type: 'line',
                        stack: '总量',
                        smooth: true, //点与点之间的幅度,false为直线
                        // symbol: 'circle',
                        // symbolSize: 5,
                        // showSymbol: true,   //是否显示点数据的圆点
                        // itemStyle: {    //设置折线的border颜色
                        //     normal: {
                        //         color: 'rgb(0,136,212)',
                        //         borderColor: 'rgba(0,136,212,0.2)',
                        //         borderWidth: 10
                        //     }
                        // },
                        label: { //设置点数据的提示
                            normal: {
                                show: true,
                                position: 'top'
                            }
                        },
                        data: ereadshourtimes,
                        markPoint: { //设置最大值和最小值
                            data: [{
                                type: 'max',
                                name: '最大值'
                            }, {
                                type: 'min',
                                name: '最小值'
                            }]
                        }

                    }]
                };
                geteread_hour.setOption(geteread_houroption);
            }
        })
    }
    function getprints_hour() {
        $.ajax({
            type:'get',
            contentType:'application/json',
            url:'../../schoolReport/getDeviceCount_Byhour',
            dataType:'json',
            async:false,
            success:function (data) {
                var printshour = [];
                var printshourtimes = [];
                for(var i=0;i<data.length;i++){
                    printshour.push(data[i].hour);
                    printshourtimes.push(data[i].prints);
                }
                var getprints_hour = echarts.init(document.getElementById('getprints_hour'));
                var getprints_houroption = {
                    animation:false,
                    backgroundColor:'white',
                    tooltip: {
                        trigger: 'axis'
                    },
                    legend: {
                        data: ['自助文印次数']
                    },
                    grid: {
                        left: '3%',
                        right: '4%',
                        bottom: '3%',
                        containLabel: true
                    },
                    xAxis: {
                        type: 'category',
                        boundaryGap: false,
                        data: printshour,
                        splitLine: { //设置X轴的网格
                            show: true,
                            interval: 'auto'
                        },
                        axisLine: { //设置X轴的颜色
                            lineStyle: {
                                color: 'blue'
                            }
                        }
                    },
                    yAxis: {
                        type: 'value',
                        axisLine: { //设置y轴的颜色
                            lineStyle: {
                                color: 'blue'
                            }
                        }
                    },
                    series: [{
                        name: '自助文印次数',
                        type: 'line',
                        stack: '总量',
                        smooth: true, //点与点之间的幅度,false为直线
                        // symbol: 'circle',
                        // symbolSize: 5,
                        // showSymbol: true,   //是否显示点数据的圆点
                        // itemStyle: {    //设置折线的border颜色
                        //     normal: {
                        //         color: 'rgb(0,136,212)',
                        //         borderColor: 'rgba(0,136,212,0.2)',
                        //         borderWidth: 10
                        //     }
                        // },
                        label: { //设置点数据的提示
                            normal: {
                                show: true,
                                position: 'top'
                            }
                        },
                        data: printshourtimes,
                        markPoint: { //设置最大值和最小值
                            data: [{
                                type: 'max',
                                name: '最大值'
                            }, {
                                type: 'min',
                                name: '最小值'
                            }]
                        }

                    }]
                };
                getprints_hour.setOption(getprints_houroption);
            }
        })
    }
    function getprintsCountBy_year() {
        $.ajax({
            type:'get',
            url:'../../printtimes/byyear',
            contentType:'application/json',
            async:false,
            dataType:'json',
            success:function (data) {
                var getprintsCountBy_year = echarts.init(document.getElementById('getprintsCountBy_year'));
                var getprintsCountBy_yearoption = {
                    animation:false,
                    backgroundColor:'white',
                    color: ['#3398DB'],
                    tooltip : {
                        trigger: 'axis',
                        axisPointer : {            // 坐标轴指示器，坐标轴触发有效
                            type : 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
                        }
                    },
                    grid: {
                        left: '3%',
                        right: '4%',
                        bottom: '3%',
                        containLabel: true
                    },
                    xAxis : [
                        {
                            name:'年',
                            type : 'category',
                            data : data.year,
                            axisTick: {
                                alignWithLabel: true
                            }
                        }
                    ],
                    yAxis : [
                        {
                            // type : 'category',
                            // data : ['10','20','30','40'],
                            name:"人次",
                            axisTick: {
                                alignWithLabel: true
                            }
                        }
                    ],
                    series : [
                        {
                            name:'自主文印次数',
                            type:'bar',
                            barWidth: '40%',
                            data:data.printtimes
                        },

                    ],
                    label: {
                        normal: {
                            show: true,
                            position: 'top',
                            formatter: '{c}'
                        }
                    },
                    itemStyle: {
                        normal: {

                            color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{
                                offset: 0,
                                color: 'rgba(17, 168,171, 1)'
                            }, {
                                offset: 1,
                                color: 'rgba(17, 168,171, 0.1)'
                            }]),
                            shadowColor: 'rgba(0, 0, 0, 0.1)',
                            shadowBlur: 10
                        }
                    }
                };
                getprintsCountBy_year.setOption(getprintsCountBy_yearoption);
            }
        });

    }
    function getprinttimesCountBy_year() {
        $.ajax({
            type:'get',
            url:'../../schoolReport/gettypeprints',
            contentType: 'application/json',
            async:false,
            dataType: 'json',
            success: function(data, textStatus, jqXHR){
                var count = [];
                for(var i=0;i<data.print.length;i++){
                    count.push({
                        value:data.print[i],
                        itemStyle:{
                            normal:{
                                color:'orange'

                            }
                        }
                    });
                }
                var getprinttimesCountBy_year = echarts.init(document.getElementById('getprinttimesCountBy_year'));
                var getprinttimesCountBy_yearoption = {
                    animation:false,
                    backgroundColor:'white',
                    animation:false,
                    xAxis: [
                        {
                            name:'年',
                            type: 'category',
                            show:true,
                            data: data.year,
                            axisPointer: {
                                type: 'shadow'
                            },
                            axisTick: {
                                show: false
                            },
                        }
                    ],

                    yAxis: [
                        {
                            type: 'value',
                            name: '打印次数',
                            /*min: 0,
                             max:100,
                             interval: 20,*/
                            axisLabel: {
                                formatter: '{value}'
                            },
                            axisTick: {
                                show: false
                            }
                        },

                    ],
                    series: [
                        {
                            /*name:'保障率',*/
                            type:'bar',
                            barWidth: '30%',
                            data:count,
                            label: {
                                normal: {
                                    show: true,
                                    position: 'top',
                                    formatter: '{c}'
                                }
                            },
                        },

                        {
                            type:'line',
                            name:'占比',
                            data:data.print
                        }
                    ],
                };
                getprinttimesCountBy_year.setOption(getprinttimesCountBy_yearoption);
            }
        });
    }
    function getcopytimesCountBy_year() {
        $.ajax({
            type:'get',
            url:'../../schoolReport/gettypeprints',
            contentType: 'application/json',
            async:false,
            dataType: 'json',
            success: function(data, textStatus, jqXHR){
                var count = [];
                for(var i=0;i<data.copy.length;i++){
                    count.push({
                        value:data.copy[i],
                        itemStyle:{
                            normal:{
                                color:'orange'

                            }
                        }
                    });
                }
                var getcopytimesCountBy_year = echarts.init(document.getElementById('getcopytimesCountBy_year'));
                var getcopytimesCountBy_yearoption = {
                    animation:false,
                    backgroundColor:'white',
                    animation:false,
                    xAxis: [
                        {
                            name:'年',
                            type: 'category',
                            show:true,
                            data: data.year,
                            axisPointer: {
                                type: 'shadow'
                            },
                            axisTick: {
                                show: false
                            },
                        }
                    ],

                    yAxis: [
                        {
                            type: 'value',
                            name: '复印次数',
                            /*min: 0,
                             max:100,
                             interval: 20,*/
                            axisLabel: {
                                formatter: '{value}'
                            },
                            axisTick: {
                                show: false
                            }
                        },

                    ],
                    series: [
                        {
                            /*name:'保障率',*/
                            type:'bar',
                            barWidth: '30%',
                            data:count,
                            label: {
                                normal: {
                                    show: true,
                                    position: 'top',
                                    formatter: '{c}'
                                }
                            },
                        },

                        {
                            type:'line',
                            name:'占比',
                            data:data.copy
                        }
                    ],
                };
                getcopytimesCountBy_year.setOption(getcopytimesCountBy_yearoption);
            }
        });
    }
    function getscantimesCountBy_year() {
        $.ajax({
            type:'get',
            url:'../../schoolReport/gettypeprints',
            contentType: 'application/json',
            async:false,
            dataType: 'json',
            success: function(data, textStatus, jqXHR){
                var count = [];
                for(var i=0;i<data.scan.length;i++){
                    count.push({
                        value:data.scan[i],
                        itemStyle:{
                            normal:{
                                color:'orange'

                            }
                        }
                    });
                }
                var getscantimesCountBy_year = echarts.init(document.getElementById('getscantimesCountBy_year'));
                var getscantimesCountBy_yearoption = {
                    animation:false,
                    backgroundColor:'white',
                    animation:false,
                    xAxis: [
                        {
                            name:'年',
                            type: 'category',
                            show:true,
                            data: data.year,
                            axisPointer: {
                                type: 'shadow'
                            },
                            axisTick: {
                                show: false
                            },
                        }
                    ],

                    yAxis: [
                        {
                            type: 'value',
                            name: '扫描次数',
                            /*min: 0,
                             max:100,
                             interval: 20,*/
                            axisLabel: {
                                formatter: '{value}'
                            },
                            axisTick: {
                                show: false
                            }
                        },

                    ],
                    series: [
                        {
                            /*name:'保障率',*/
                            type:'bar',
                            barWidth: '30%',
                            data:count,
                            label: {
                                normal: {
                                    show: true,
                                    position: 'top',
                                    formatter: '{c}'
                                }
                            },
                        },

                        {
                            type:'line',
                            name:'占比',
                            data:data.scan
                        }
                    ],
                };
                getscantimesCountBy_year.setOption(getscantimesCountBy_yearoption);
            }
        });
    }
    $(function () {
        getResourceCountBy_year();
        getGctrlsCountBy_year();
        getGctrlsCountBy_month();
        getmankindGctrl_Byoneyear();
        getmankindCount_Byyear();
        getBook_LendCountBy_year();
        getBookkindAllCount_Byyear();
        getBook_LendCountBy_academyAndyear();
        getbooklendPeopleAndCount_Byhour();
        getlend_student_type();
        getlendrenew_student_type();
        geICdurationCountBy_year();
        geICdurationBy_year();
        geteread_hour();
        getprints_hour();
        getprintsCountBy_year();
        getprinttimesCountBy_year();
        getcopytimesCountBy_year();
        getscantimesCountBy_year();
        var img_Book_Amount =echarts.init(document.getElementById("getResourceCountBy_year")).getDataURL();
        var img_gctrl_amount =echarts.init(document.getElementById("getGctrlsCountBy_year")).getDataURL();
        var img_month_amount =echarts.init(document.getElementById("getGctrlsCountBy_month")).getDataURL();
        var img_type_percent1 =echarts.init(document.getElementById("getmankindGctrl_Byoneyear")).getDataURL();
        var img_type_percent2 =echarts.init(document.getElementById("getmankindCount_Byyear")).getDataURL();
        var img_lend_yearamount =echarts.init(document.getElementById("getBook_LendCountBy_year")).getDataURL();
        var img_type_reader =echarts.init(document.getElementById("getBookkindAllCount_Byyear")).getDataURL();
        var img_academy_img =echarts.init(document.getElementById("getBook_LendCountBy_academyAndyear")).getDataURL();
        var img_leader_img =echarts.init(document.getElementById("getbooklendPeopleAndCount_Byhour")).getDataURL();
        var img_borrow_img1 =echarts.init(document.getElementById("getlend_student_type")).getDataURL();
        var img_borrow_img2 =echarts.init(document.getElementById("getlendrenew_student_type")).getDataURL();
        var img_read_img =echarts.init(document.getElementById("geICdurationCountBy_year")).getDataURL();
        var img_seat_img =echarts.init(document.getElementById("geICdurationBy_year")).getDataURL();
        var img_ebook_spend =echarts.init(document.getElementById("geteread_hour")).getDataURL();
        var img_print_amount =echarts.init(document.getElementById("getprintsCountBy_year")).getDataURL();
        var img_print_dy =echarts.init(document.getElementById("getprinttimesCountBy_year")).getDataURL();
        var img_print_fy =echarts.init(document.getElementById("getcopytimesCountBy_year")).getDataURL();
        var img_print_sm =echarts.init(document.getElementById("getscantimesCountBy_year")).getDataURL();
        var img_print_day =echarts.init(document.getElementById("getprints_hour")).getDataURL();
        var postdata = {
            "img_Book_Amount" :img_Book_Amount,
            "img_gctrl_amount" :img_gctrl_amount,
            "img_month_amount" :img_month_amount,
            "img_type_percent1" :img_type_percent1,
            "img_type_percent2" :img_type_percent2,
            "img_lend_yearamount" :img_lend_yearamount,
            "img_type_reader" :img_type_reader,
            "img_academy_img" :img_academy_img,
            "img_leader_img" : img_leader_img,
            "img_borrow_img1" :img_borrow_img1,
            "img_borrow_img2" :img_borrow_img2,
            "img_read_img" :img_read_img,
            "img_seat_img" :img_seat_img,
            "img_ebook_spend" :img_ebook_spend,
            "img_print_amount":img_print_amount,
            "img_print_dy":img_print_dy,
            "img_print_fy":img_print_fy,
            "img_print_sm":img_print_sm,
            "img_print_day" :img_print_day,
        }
        $.ajax({
            type:"POST",
            contentType: 'application/json;charset=UTF-8',
            data:JSON.stringify(postdata),
            url:"../../report/getreport",
            dataType: 'json',
            success: function(data, textStatus, jqXHR){
                try{
                    var elemIF = document.createElement("iframe");
                    elemIF.src = "../../report/2.docx";
                    elemIF.style.display = "none";
                    document.body.appendChild(elemIF);
                }catch(e){

                }
            }
        });
    });
</script>
<body>
<div style="width: 100%;height: 100%;">
    <div style="height: 500px; left: 15%;width: 70%;position: relative;" id="getResourceCountBy_year"></div>
    <div style="height: 500px; left: 15%;width: 70%;position: relative;" id="getGctrlsCountBy_year"></div>
    <div style="height: 500px; left: 15%;width: 70%;position: relative;" id="getGctrlsCountBy_month"></div>
    <div style="height: 500px; left: 15%;width: 70%;position: relative;" id="getmankindGctrl_Byoneyear"></div>
    <div style="height: 500px; left: 15%;width: 70%;position: relative;" id="getmankindCount_Byyear"></div>
    <div style="height: 500px; left: 15%;width: 70%;position: relative;" id="getBook_LendCountBy_year"></div>
    <div style="height: 500px; left: 15%;width: 70%;position: relative;" id="getBookkindAllCount_Byyear"></div>
    <div style="height: 500px; left: 15%;width: 70%;position: relative;" id="getBook_LendCountBy_academyAndyear"></div>
    <div style="height: 500px; left: 15%;width: 70%;position: relative;" id="getbooklendPeopleAndCount_Byhour"></div>
    <div style="height: 500px; left: 15%;width: 70%;position: relative;" id="getlend_student_type"></div>
    <div style="height: 500px; left: 15%;width: 70%;position: relative;" id="getlendrenew_student_type"></div>
    <div style="height: 500px; left: 15%;width: 70%;position: relative;" id="geICdurationCountBy_year"></div>
    <div style="height: 500px; left: 15%;width: 70%;position: relative;" id="geICdurationBy_year"></div>
    <div style="height: 500px; left: 15%;width: 70%;position: relative;" id="geteread_hour"></div>
    <div style="height: 500px; left: 15%;width: 70%;position: relative;" id="getprints_hour"></div>
    <div style="height: 500px; left: 15%;width: 70%;position: relative;" id="getprintsCountBy_year"></div>
    <div style="height: 500px; left: 15%;width: 70%;position: relative;" id="getprinttimesCountBy_year"></div>
    <div style="height: 500px; left: 15%;width: 70%;position: relative;" id="getcopytimesCountBy_year"></div>
    <div style="height: 500px; left: 15%;width: 70%;position: relative;" id="getscantimesCountBy_year"></div>
</div>
</body>
</html>